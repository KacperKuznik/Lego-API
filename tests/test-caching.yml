config:
  target: "{{ $env.TARGET_URL }}"
  plugins:
    metrics-by-endpoint: {}
  processor: "./test-utils.js"
  phases:
    - name: "Main test" # MAIN TESTS: duration: 30s, with 10 new clients/sec
      duration: 30 # NOTE: you should adjust the number of clients per second depending on the complexity
      arrivalRate: 10 # of your scenarios. you need to try a number that can be handled by the server.

scenarios:
  - name: "Create User"
    weight: 3
    flow:
      - function: "generateUserData"
      - post:
          url: "/user"
          json:
            nickname: "{{ nickname }}"
            name: "{{ name }}"
            password: "{{ password }}"

  - name: "List Users"
    weight: 1
    flow:
      - get:
          url: "/user"

  - name: "Create LegoSet"
    weight: 3
    flow:
      - function: "generateLegoSetData"
      - function: "createLegoSet"

  - name: "List LegoSets"
    weight: 1
    flow:
      - get:
          url: "/legoset"

  - name: "Get recent legosets"
    weight: 1
    flow:
      - post:
          url: "/legoset/recent"
